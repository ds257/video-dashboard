<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Video Feature Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f6f9fc;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
    }

    h1 {
      font-size: 1.8rem;
      color: #2a4b7c;
      margin-bottom: 10px;
    }

    .video-container {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      max-width: 720px;
      width: 100%;
      margin-bottom: 20px;
      text-align: center;
    }

    video {
      max-width: 100%;
      border-radius: 8px;
      margin: 15px 0;
    }

    .features {
      text-align: left;
      font-size: 0.95rem;
      margin-top: 10px;
    }

    .feature {
      margin-bottom: 6px;
    }

    .feature b {
      color: #2a4b7c;
    }

    .placeholder {
      font-style: italic;
      color: #999;
    }

    .nav-buttons {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 20px;
    }

    .nav-buttons button {
      background: #2a4b7c;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .nav-buttons button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <h1>ðŸ§  Mental Health Video Viewer</h1>
  <div id="videoViewer" class="video-container">Loading...</div>
  <div class="nav-buttons">
    <button id="prevBtn">Previous</button>
    <button id="nextBtn">Next</button>
  </div>

  <script>
    let currentIndex = 0;
    let videoData = [];

    window.onload = () => {
      fetch("final_merged_with_audio.csv")
        .then(res => res.text())
        .then(csv => {
          Papa.parse(csv, {
            header: true,
            skipEmptyLines: true,
            complete: results => {
              videoData = results.data;
              showVideo(currentIndex);
              updateButtons();
            }
          });
        });
    };

    function showVideo(index) {
      const container = document.getElementById("videoViewer");
      const video = videoData[index];

      container.innerHTML = `
        <h2>${video.video_filename || "Untitled Video"}</h2>
        ${video.tiktokurl && video.tiktokurl.endsWith(".mp4")
          ? `<video controls src="${video.tiktokurl}"></video>`
          : `<p class="placeholder">No video preview available.</p>`
        }

        <div class="features">
          <div class="feature"><b>Frame Rate:</b> ${video.frame_rate || "-"}</div>
          <div class="feature"><b>Has Music:</b> ${video.has_music || "-"}</div>
          <div class="feature"><b>Has Speech:</b> ${video.has_speech || "-"}</div>
          <div class="feature"><b>Has Persuasive Content:</b> ${video.has_persuasive || "-"}</div>

          <!-- Placeholders -->
          <div class="feature"><b>ADHD Score:</b> <span class="placeholder">(to be added)</span></div>
          <div class="feature"><b>Emotion Category:</b> <span class="placeholder">(to be added)</span></div>
        </div>
      `;
    }

    function updateButtons() {
      document.getElementById("prevBtn").disabled = currentIndex === 0;
      document.getElementById("nextBtn").disabled = currentIndex === videoData.length - 1;
    }

    document.getElementById("prevBtn").addEventListener("click", () => {
      if (currentIndex > 0) {
        currentIndex--;
        showVideo(currentIndex);
        updateButtons();
      }
    });

    document.getElementById("nextBtn").addEventListener("click", () => {
      if (currentIndex < videoData.length - 1) {
        currentIndex++;
        showVideo(currentIndex);
        updateButtons();
      }
    });
  </script>
</body>
</html>
